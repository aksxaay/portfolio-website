!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Matter=e()}(function(){return function n(i,r,s){function a(t,e){if(!r[t]){if(!i[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(l)return l(t,!0);o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}o=r[t]={exports:{}};i[t][0].call(o.exports,function(e){return a(i[t][1][e]||e)},o,o.exports,n,i,r,s)}return r[t].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,o){var l={};t.exports=l;var c=e("../geometry/Vertices"),d=e("../geometry/Vector"),i=e("../core/Sleeping"),n=(e("../render/Render"),e("../core/Common")),u=e("../geometry/Bounds"),p=e("../geometry/Axes");!function(){l._inertiaScale=4,l._nextCollidingGroupId=1,l._nextNonCollidingGroupId=-1,l._nextCategory=1,l.create=function(e){var t={id:n.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:c.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},t=n.extend(t,e);return o(t,e),t},l.nextGroup=function(e){return e?l._nextNonCollidingGroupId--:l._nextCollidingGroupId++},l.nextCategory=function(){return l._nextCategory=l._nextCategory<<1,l._nextCategory};var o=function(e,t){t=t||{},l.set(e,{bounds:e.bounds||u.create(e.vertices),positionPrev:e.positionPrev||d.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),c.rotate(e.vertices,e.angle,e.position),p.rotate(e.axes,e.angle),u.update(e.bounds,e.vertices,e.velocity),l.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});t=e.isStatic?"#2e2b44":n.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]);e.render.fillStyle=e.render.fillStyle||t,e.render.strokeStyle=e.render.strokeStyle||"#000",e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};l.set=function(e,t,o){for(var n in"string"==typeof t&&(n=t,(t={})[n]=o),t)if(o=t[n],t.hasOwnProperty(n))switch(n){case"isStatic":l.setStatic(e,o);break;case"isSleeping":i.set(e,o);break;case"mass":l.setMass(e,o);break;case"density":l.setDensity(e,o);break;case"inertia":l.setInertia(e,o);break;case"vertices":l.setVertices(e,o);break;case"position":l.setPosition(e,o);break;case"angle":l.setAngle(e,o);break;case"velocity":l.setVelocity(e,o);break;case"angularVelocity":l.setAngularVelocity(e,o);break;case"parts":l.setParts(e,o);break;default:e[n]=o}},l.setStatic=function(e,t){for(var o=0;o<e.parts.length;o++){var n=e.parts[o];(n.isStatic=t)?(n._original={restitution:n.restitution,friction:n.friction,mass:n.mass,inertia:n.inertia,density:n.density,inverseMass:n.inverseMass,inverseInertia:n.inverseInertia},n.restitution=0,n.friction=1,n.mass=n.inertia=n.density=1/0,n.inverseMass=n.inverseInertia=0,n.positionPrev.x=n.position.x,n.positionPrev.y=n.position.y,n.anglePrev=n.angle,n.angularVelocity=0,n.speed=0,n.angularSpeed=0,n.motion=0):n._original&&(n.restitution=n._original.restitution,n.friction=n._original.friction,n.mass=n._original.mass,n.inertia=n._original.inertia,n.density=n._original.density,n.inverseMass=n._original.inverseMass,n.inverseInertia=n._original.inverseInertia,delete n._original)}},l.setMass=function(e,t){var o=e.inertia/(e.mass/6);e.inertia=t/6*o,e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},l.setDensity=function(e,t){l.setMass(e,t*e.area),e.density=t},l.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},l.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=c.create(t,e),e.axes=p.fromVertices(e.vertices),e.area=c.area(e.vertices),l.setMass(e,e.density*e.area);t=c.centre(e.vertices);c.translate(e.vertices,t,-1),l.setInertia(e,l._inertiaScale*c.inertia(e.vertices,e.mass)),c.translate(e.vertices,e.position),u.update(e.bounds,e.vertices,e.velocity)},l.setParts=function(e,t,o){for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,r=0;r<t.length;r++){var n=t[r];n!==e&&(n.parent=e).parts.push(n)}if(1!==e.parts.length){if(o=void 0===o||o){for(var i=[],r=0;r<t.length;r++)i=i.concat(t[r].vertices);c.clockwiseSort(i);var o=c.hull(i),s=c.centre(o);l.setVertices(e,o),c.translate(e.vertices,s)}s=l._totalProperties(e);e.area=s.area,(e.parent=e).position.x=s.centre.x,e.position.y=s.centre.y,e.positionPrev.x=s.centre.x,e.positionPrev.y=s.centre.y,l.setMass(e,s.mass),l.setInertia(e,s.inertia),l.setPosition(e,s.centre)}},l.setPosition=function(e,t){var o=d.sub(t,e.position);e.positionPrev.x+=o.x,e.positionPrev.y+=o.y;for(var n=0;n<e.parts.length;n++){var i=e.parts[n];i.position.x+=o.x,i.position.y+=o.y,c.translate(i.vertices,o),u.update(i.bounds,i.vertices,e.velocity)}},l.setAngle=function(e,t){var o=t-e.angle;e.anglePrev+=o;for(var n=0;n<e.parts.length;n++){var i=e.parts[n];i.angle+=o,c.rotate(i.vertices,o,e.position),p.rotate(i.axes,o),u.update(i.bounds,i.vertices,e.velocity),0<n&&d.rotateAbout(i.position,o,e.position,i.position)}},l.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=d.magnitude(e.velocity)},l.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=Math.abs(e.angularVelocity)},l.translate=function(e,t){l.setPosition(e,d.add(e.position,t))},l.rotate=function(e,t,o){var n,i,r,s;o&&(n=Math.cos(t),i=Math.sin(t),r=e.position.x-o.x,s=e.position.y-o.y,l.setPosition(e,{x:o.x+(r*n-s*i),y:o.y+(r*i+s*n)})),l.setAngle(e,e.angle+t)},l.scale=function(e,t,o,n){var i=0,r=0;n=n||e.position;for(var s=0;s<e.parts.length;s++){var a=e.parts[s];c.scale(a.vertices,t,o,n),a.axes=p.fromVertices(a.vertices),a.area=c.area(a.vertices),l.setMass(a,e.density*a.area),c.translate(a.vertices,{x:-a.position.x,y:-a.position.y}),l.setInertia(a,l._inertiaScale*c.inertia(a.vertices,a.mass)),c.translate(a.vertices,{x:a.position.x,y:a.position.y}),0<s&&(i+=a.area,r+=a.inertia),a.position.x=n.x+(a.position.x-n.x)*t,a.position.y=n.y+(a.position.y-n.y)*o,u.update(a.bounds,a.vertices,e.velocity)}1<e.parts.length&&(e.area=i,e.isStatic||(l.setMass(e,e.density*i),l.setInertia(e,r))),e.circleRadius&&(t===o?e.circleRadius*=t:e.circleRadius=null)},l.update=function(e,t,o,n){var i=Math.pow(t*o*e.timeScale,2),r=1-e.frictionAir*o*e.timeScale,t=e.position.x-e.positionPrev.x,o=e.position.y-e.positionPrev.y;e.velocity.x=t*r*n+e.force.x/e.mass*i,e.velocity.y=o*r*n+e.force.y/e.mass*i,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*r*n+e.torque/e.inertia*i,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=d.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var s=0;s<e.parts.length;s++){var a=e.parts[s];c.translate(a.vertices,e.velocity),0<s&&(a.position.x+=e.velocity.x,a.position.y+=e.velocity.y),0!==e.angularVelocity&&(c.rotate(a.vertices,e.angularVelocity,e.position),p.rotate(a.axes,e.angularVelocity),0<s&&d.rotateAbout(a.position,e.angularVelocity,e.position,a.position)),u.update(a.bounds,a.vertices,e.velocity)}},l.applyForce=function(e,t,o){e.force.x+=o.x,e.force.y+=o.y;var n=t.x-e.position.x,t=t.y-e.position.y;e.torque+=n*o.y-t*o.x},l._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},o=1===e.parts.length?0:1;o<e.parts.length;o++){var n=e.parts[o],i=n.mass!==1/0?n.mass:1;t.mass+=i,t.area+=n.area,t.inertia+=n.inertia,t.centre=d.add(t.centre,d.mult(n.position,i))}return t.centre=d.div(t.centre,t.mass),t}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(e,t,o){var u={};t.exports=u;var s=e("../core/Events"),r=e("../core/Common"),a=e("../geometry/Bounds"),p=e("./Body");u.create=function(e){return r.extend({id:r.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},e)},u.setModified=function(e,t,o,n){if(e.isModified=t,o&&e.parent&&u.setModified(e.parent,t,o,n),n)for(var i=0;i<e.composites.length;i++){var r=e.composites[i];u.setModified(r,t,o,n)}},u.add=function(e,t){var o=[].concat(t);s.trigger(e,"beforeAdd",{object:t});for(var n=0;n<o.length;n++){var i=o[n];switch(i.type){case"body":if(i.parent!==i){r.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}u.addBody(e,i);break;case"constraint":u.addConstraint(e,i);break;case"composite":u.addComposite(e,i);break;case"mouseConstraint":u.addConstraint(e,i.constraint)}}return s.trigger(e,"afterAdd",{object:t}),e},u.remove=function(e,t,o){var n=[].concat(t);s.trigger(e,"beforeRemove",{object:t});for(var i=0;i<n.length;i++){var r=n[i];switch(r.type){case"body":u.removeBody(e,r,o);break;case"constraint":u.removeConstraint(e,r,o);break;case"composite":u.removeComposite(e,r,o);break;case"mouseConstraint":u.removeConstraint(e,r.constraint)}}return s.trigger(e,"afterRemove",{object:t}),e},u.addComposite=function(e,t){return e.composites.push(t),t.parent=e,u.setModified(e,!0,!0,!1),e},u.removeComposite=function(e,t,o){var n=r.indexOf(e.composites,t);if(-1!==n&&(u.removeCompositeAt(e,n),u.setModified(e,!0,!0,!1)),o)for(var i=0;i<e.composites.length;i++)u.removeComposite(e.composites[i],t,!0);return e},u.removeCompositeAt=function(e,t){return e.composites.splice(t,1),u.setModified(e,!0,!0,!1),e},u.addBody=function(e,t){return e.bodies.push(t),u.setModified(e,!0,!0,!1),e},u.removeBody=function(e,t,o){var n=r.indexOf(e.bodies,t);if(-1!==n&&(u.removeBodyAt(e,n),u.setModified(e,!0,!0,!1)),o)for(var i=0;i<e.composites.length;i++)u.removeBody(e.composites[i],t,!0);return e},u.removeBodyAt=function(e,t){return e.bodies.splice(t,1),u.setModified(e,!0,!0,!1),e},u.addConstraint=function(e,t){return e.constraints.push(t),u.setModified(e,!0,!0,!1),e},u.removeConstraint=function(e,t,o){var n=r.indexOf(e.constraints,t);if(-1!==n&&u.removeConstraintAt(e,n),o)for(var i=0;i<e.composites.length;i++)u.removeConstraint(e.composites[i],t,!0);return e},u.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),u.setModified(e,!0,!0,!1),e},u.clear=function(e,t,o){if(o)for(var n=0;n<e.composites.length;n++)u.clear(e.composites[n],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,u.setModified(e,!0,!0,!1),e},u.allBodies=function(e){for(var t=[].concat(e.bodies),o=0;o<e.composites.length;o++)t=t.concat(u.allBodies(e.composites[o]));return t},u.allConstraints=function(e){for(var t=[].concat(e.constraints),o=0;o<e.composites.length;o++)t=t.concat(u.allConstraints(e.composites[o]));return t},u.allComposites=function(e){for(var t=[].concat(e.composites),o=0;o<e.composites.length;o++)t=t.concat(u.allComposites(e.composites[o]));return t},u.get=function(e,t,o){var n,i;switch(o){case"body":n=u.allBodies(e);break;case"constraint":n=u.allConstraints(e);break;case"composite":n=u.allComposites(e).concat(e)}return!n||0===(i=n.filter(function(e){return e.id.toString()===t.toString()})).length?null:i[0]},u.move=function(e,t,o){return u.remove(e,t),u.add(o,t),e},u.rebase=function(e){for(var t=u.allBodies(e).concat(u.allConstraints(e)).concat(u.allComposites(e)),o=0;o<t.length;o++)t[o].id=r.nextId();return u.setModified(e,!0,!0,!1),e},u.translate=function(e,t,o){for(var n=o?u.allBodies(e):e.bodies,i=0;i<n.length;i++)p.translate(n[i],t);return u.setModified(e,!0,!0,!1),e},u.rotate=function(e,t,o,n){for(var i=Math.cos(t),r=Math.sin(t),s=n?u.allBodies(e):e.bodies,a=0;a<s.length;a++){var l=s[a],c=l.position.x-o.x,d=l.position.y-o.y;p.setPosition(l,{x:o.x+(c*i-d*r),y:o.y+(c*r+d*i)}),p.rotate(l,t)}return u.setModified(e,!0,!0,!1),e},u.scale=function(e,t,o,n,i){for(var r=i?u.allBodies(e):e.bodies,s=0;s<r.length;s++){var a=r[s],l=a.position.x-n.x,c=a.position.y-n.y;p.setPosition(a,{x:n.x+l*t,y:n.y+c*o}),p.scale(a,t,o)}return u.setModified(e,!0,!0,!1),e},u.bounds=function(e){for(var t=u.allBodies(e),o=[],n=0;n<t.length;n+=1){var i=t[n];o.push(i.bounds.min,i.bounds.max)}return a.create(o)}},{"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"./Body":1}],3:[function(e,t,o){var n={};t.exports=n;var i=e("./Composite"),r=(e("../constraint/Constraint"),e("../core/Common"));n.create=function(e){var t=i.create();return r.extend(t,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}},e)}},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(e,t,o){var n={};(t.exports=n).create=function(e){return{id:n.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}},n.id=function(e){return e.body.id+"_"+e.index}},{}],5:[function(e,t,o){var p={};t.exports=p;var m=e("./SAT"),f=e("./Pair"),y=e("../geometry/Bounds");p.collisions=function(e,t){for(var o=[],n=t.pairs.table,i=0;i<e.length;i++){var r=e[i][0],s=e[i][1];if((!r.isStatic&&!r.isSleeping||!s.isStatic&&!s.isSleeping)&&p.canCollide(r.collisionFilter,s.collisionFilter)&&y.overlaps(r.bounds,s.bounds))for(var a=1<r.parts.length?1:0;a<r.parts.length;a++)for(var l=r.parts[a],c=1<s.parts.length?1:0;c<s.parts.length;c++){var d,u=s.parts[c];(l===r&&u===s||y.overlaps(l.bounds,u.bounds))&&(d=(d=n[f.id(l,u)])&&d.isActive?d.collision:null,(d=m.collides(l,u,d)).collided&&o.push(d))}}return o},p.canCollide=function(e,t){return e.group===t.group&&0!==e.group?0<e.group:0!=(e.mask&t.category)&&0!=(t.mask&e.category)}},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(e,t,o){var g={};t.exports=g;var a=e("./Pair"),n=e("./Detector"),r=e("../core/Common");g.create=function(e){var t={controller:g,detector:n.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return r.extend(t,e)},g.update=function(e,t,o,n){for(var i,r,s=o.world,a=e.buckets,l=!1,c=0;c<t.length;c++){var d=t[c];if((!d.isSleeping||n)&&!(d.bounds.max.x<s.bounds.min.x||d.bounds.min.x>s.bounds.max.x||d.bounds.max.y<s.bounds.min.y||d.bounds.min.y>s.bounds.max.y)){var u=g._getRegion(e,d);if(!d.region||u.id!==d.region.id||n){d.region&&!n||(d.region=u);for(var p=g._regionUnion(u,d.region),m=p.startCol;m<=p.endCol;m++)for(i=p.startRow;i<=p.endRow;i++){var f=a[r=g._getBucketId(m,i)],y=m>=u.startCol&&m<=u.endCol&&i>=u.startRow&&i<=u.endRow,v=m>=d.region.startCol&&m<=d.region.endCol&&i>=d.region.startRow&&i<=d.region.endRow;!y&&v&&v&&f&&g._bucketRemoveBody(e,f,d),(d.region===u||y&&!v||n)&&(f=f||g._createBucket(a,r),g._bucketAddBody(e,f,d))}d.region=u,l=!0}}}l&&(e.pairsList=g._createActivePairsList(e))},g.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},g._regionUnion=function(e,t){var o=Math.min(e.startCol,t.startCol),n=Math.max(e.endCol,t.endCol),i=Math.min(e.startRow,t.startRow),t=Math.max(e.endRow,t.endRow);return g._createRegion(o,n,i,t)},g._getRegion=function(e,t){var o=t.bounds,n=Math.floor(o.min.x/e.bucketWidth),i=Math.floor(o.max.x/e.bucketWidth),t=Math.floor(o.min.y/e.bucketHeight),e=Math.floor(o.max.y/e.bucketHeight);return g._createRegion(n,i,t,e)},g._createRegion=function(e,t,o,n){return{id:e+","+t+","+o+","+n,startCol:e,endCol:t,startRow:o,endRow:n}},g._getBucketId=function(e,t){return"C"+e+"R"+t},g._createBucket=function(e,t){return e[t]=[]},g._bucketAddBody=function(e,t,o){for(var n=0;n<t.length;n++){var i,r,s=t[n];o.id===s.id||o.isStatic&&s.isStatic||(i=a.id(o,s),(r=e.pairs[i])?r[2]+=1:e.pairs[i]=[o,s,1])}t.push(o)},g._bucketRemoveBody=function(e,t,o){t.splice(r.indexOf(t,o),1);for(var n=0;n<t.length;n++){var i=t[n],i=a.id(o,i),i=e.pairs[i];i&&--i[2]}},g._createActivePairsList=function(e){for(var t,o=[],n=r.keys(e.pairs),i=0;i<n.length;i++)0<(t=e.pairs[n[i]])[2]?o.push(t):delete e.pairs[n[i]];return o}},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(e,t,o){var p={};t.exports=p;var m=e("./Contact");p.create=function(e,t){var o=e.bodyA,n=e.bodyB,i=e.parentA,r=e.parentB,r={id:p.id(o,n),bodyA:o,bodyB:n,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:o.isSensor||n.isSensor,timeCreated:t,timeUpdated:t,inverseMass:i.inverseMass+r.inverseMass,friction:Math.min(i.friction,r.friction),frictionStatic:Math.max(i.frictionStatic,r.frictionStatic),restitution:Math.max(i.restitution,r.restitution),slop:Math.max(i.slop,r.slop)};return p.update(r,e,t),r},p.update=function(e,t,o){var n=e.contacts,i=t.supports,r=e.activeContacts,s=t.parentA,a=t.parentB;if(e.collision=t,e.inverseMass=s.inverseMass+a.inverseMass,e.friction=Math.min(s.friction,a.friction),e.frictionStatic=Math.max(s.frictionStatic,a.frictionStatic),e.restitution=Math.max(s.restitution,a.restitution),e.slop=Math.max(s.slop,a.slop),r.length=0,t.collided){for(var l=0;l<i.length;l++){var c=i[l],d=m.id(c),u=n[d];u?r.push(u):r.push(n[d]=m.create(c))}e.separation=t.depth,p.setActive(e,!0,o)}else!0===e.isActive&&p.setActive(e,!1,o)},p.setActive=function(e,t,o){t?(e.isActive=!0,e.timeUpdated=o):(e.isActive=!1,e.activeContacts.length=0)},p.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},{"./Contact":4}],8:[function(e,t,o){var c={};t.exports=c;var m=e("./Pair"),f=e("../core/Common");c._pairMaxIdleLife=1e3,c.create=function(e){return f.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},c.update=function(e,t,o){var n,i,r,s,a=e.list,l=e.table,c=e.collisionStart,d=e.collisionEnd,u=e.collisionActive,p=[];for(c.length=0,d.length=0,s=u.length=0;s<t.length;s++)(n=t[s]).collided&&(i=m.id(n.bodyA,n.bodyB),p.push(i),(r=l[i])?((r.isActive?u:c).push(r),m.update(r,n,o)):(r=m.create(n,o),l[i]=r,c.push(r),a.push(r)));for(s=0;s<a.length;s++)(r=a[s]).isActive&&-1===f.indexOf(p,r.id)&&(m.setActive(r,!1,o),d.push(r))},c.removeOld=function(e,t){for(var o,n,i,r=e.list,s=e.table,a=[],l=0;l<r.length;l++)(n=(o=r[l]).collision).bodyA.isSleeping||n.bodyB.isSleeping?o.timeUpdated=t:t-o.timeUpdated>c._pairMaxIdleLife&&a.push(l);for(l=0;l<a.length;l++)delete s[(o=r[i=a[l]-l]).id],r.splice(i,1)},c.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},{"../core/Common":14,"./Pair":7}],9:[function(e,t,o){var d={};t.exports=d;var u=e("../geometry/Vector"),a=e("./SAT"),l=e("../geometry/Bounds"),p=e("../factory/Bodies"),c=e("../geometry/Vertices");d.collides=function(e,t){for(var o=[],n=0;n<t.length;n++){var i=t[n];if(l.overlaps(i.bounds,e.bounds))for(var r=1===i.parts.length?0:1;r<i.parts.length;r++){var s=i.parts[r];if(l.overlaps(s.bounds,e.bounds)){s=a.collides(s,e);if(s.collided){o.push(s);break}}}}return o},d.ray=function(e,t,o,n){n=n||1e-100;for(var i=u.angle(t,o),r=u.magnitude(u.sub(t,o)),s=.5*(o.x+t.x),t=.5*(o.y+t.y),i=p.rectangle(s,t,r,n,{angle:i}),a=d.collides(i,e),l=0;l<a.length;l+=1){var c=a[l];c.body=c.bodyB=c.bodyA}return a},d.region=function(e,t,o){for(var n=[],i=0;i<e.length;i++){var r=e[i],s=l.overlaps(r.bounds,t);(s&&!o||!s&&o)&&n.push(r)}return n},d.point=function(e,t){for(var o=[],n=0;n<e.length;n++){var i=e[n];if(l.contains(i.bounds,t))for(var r=1===i.parts.length?0:1;r<i.parts.length;r++){var s=i.parts[r];if(l.contains(s.bounds,t)&&c.contains(s.vertices,t)){o.push(i);break}}}return o}},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(e,t,o){var _={};t.exports=_;var r=e("../geometry/Vertices"),T=e("../geometry/Vector"),R=e("../core/Common"),s=e("../geometry/Bounds");_._restingThresh=4,_._restingThreshTangent=6,_._positionDampen=.9,_._positionWarming=.8,_._frictionNormalMultiplier=5,_.preSolvePosition=function(e){for(var t,o,n=0;n<e.length;n++)(t=e[n]).isActive&&(o=t.activeContacts.length,t.collision.parentA.totalContacts+=o,t.collision.parentB.totalContacts+=o)},_.solvePosition=function(e,t){for(var o,n,i,r,s,a,l,c,d=T._temp[0],u=T._temp[1],p=T._temp[2],m=T._temp[3],f=0;f<e.length;f++)(o=e[f]).isActive&&!o.isSensor&&(i=(n=o.collision).parentA,r=n.parentB,s=n.normal,a=T.sub(T.add(r.positionImpulse,r.position,d),T.add(i.positionImpulse,T.sub(r.position,n.penetration,u),p),m),o.separation=T.dot(s,a));for(f=0;f<e.length;f++)(o=e[f]).isActive&&!o.isSensor&&(i=(n=o.collision).parentA,r=n.parentB,s=n.normal,c=(o.separation-o.slop)*t,(i.isStatic||r.isStatic)&&(c*=2),i.isStatic||i.isSleeping||(l=_._positionDampen/i.totalContacts,i.positionImpulse.x+=s.x*c*l,i.positionImpulse.y+=s.y*c*l),r.isStatic||r.isSleeping||(l=_._positionDampen/r.totalContacts,r.positionImpulse.x-=s.x*c*l,r.positionImpulse.y-=s.y*c*l))},_.postSolvePosition=function(e){for(var t=0;t<e.length;t++){var o=e[t];if((o.totalContacts=0)!==o.positionImpulse.x||0!==o.positionImpulse.y){for(var n=0;n<o.parts.length;n++){var i=o.parts[n];r.translate(i.vertices,o.positionImpulse),s.update(i.bounds,i.vertices,o.velocity),i.position.x+=o.positionImpulse.x,i.position.y+=o.positionImpulse.y}o.positionPrev.x+=o.positionImpulse.x,o.positionPrev.y+=o.positionImpulse.y,T.dot(o.positionImpulse,o.velocity)<0?(o.positionImpulse.x=0,o.positionImpulse.y=0):(o.positionImpulse.x*=_._positionWarming,o.positionImpulse.y*=_._positionWarming)}}},_.preSolveVelocity=function(e){for(var t,o,n,i,r,s,a,l,c,d,u,p=T._temp[0],m=T._temp[1],f=0;f<e.length;f++)if((n=e[f]).isActive&&!n.isSensor)for(o=n.activeContacts,i=(n=n.collision).parentA,r=n.parentB,s=n.normal,a=n.tangent,t=0;t<o.length;t++)l=(d=o[t]).vertex,c=d.normalImpulse,d=d.tangentImpulse,0===c&&0===d||(p.x=s.x*c+a.x*d,p.y=s.y*c+a.y*d,i.isStatic||i.isSleeping||(u=T.sub(l,i.position,m),i.positionPrev.x+=p.x*i.inverseMass,i.positionPrev.y+=p.y*i.inverseMass,i.anglePrev+=T.cross(u,p)*i.inverseInertia),r.isStatic||r.isSleeping||(u=T.sub(l,r.position,m),r.positionPrev.x-=p.x*r.inverseMass,r.positionPrev.y-=p.y*r.inverseMass,r.anglePrev-=T.cross(u,p)*r.inverseInertia))},_.solveVelocity=function(e,t){for(var o=t*t,n=T._temp[0],i=T._temp[1],r=T._temp[2],s=T._temp[3],a=T._temp[4],l=T._temp[5],c=0;c<e.length;c++){var d=e[c];if(d.isActive&&!d.isSensor){var u=d.collision,p=u.parentA,m=u.parentB,f=u.normal,y=u.tangent,v=d.activeContacts,g=1/v.length;p.velocity.x=p.position.x-p.positionPrev.x,p.velocity.y=p.position.y-p.positionPrev.y,m.velocity.x=m.position.x-m.positionPrev.x,m.velocity.y=m.position.y-m.positionPrev.y,p.angularVelocity=p.angle-p.anglePrev,m.angularVelocity=m.angle-m.anglePrev;for(var x=0;x<v.length;x++){var h=v[x],b=h.vertex,w=T.sub(b,p.position,i),S=T.sub(b,m.position,r),C=T.add(p.velocity,T.mult(T.perp(w),p.angularVelocity),s),A=T.add(m.velocity,T.mult(T.perp(S),m.angularVelocity),a),P=T.sub(C,A,l),B=T.dot(f,P),M=T.dot(y,P),k=Math.abs(M),I=R.sign(M),b=(1+d.restitution)*B,C=R.clamp(d.separation+B,0,1)*_._frictionNormalMultiplier,A=M,P=1/0;k>d.friction*d.frictionStatic*C*o&&(A=R.clamp(d.friction*I*o,-(P=k),P));I=T.cross(w,f),k=T.cross(S,f),k=g/(p.inverseMass+m.inverseMass+p.inverseInertia*I*I+m.inverseInertia*k*k);b*=k,A*=k,B<0&&B*B>_._restingThresh*o?h.normalImpulse=0:(B=h.normalImpulse,h.normalImpulse=Math.min(h.normalImpulse+b,0),b=h.normalImpulse-B),M*M>_._restingThreshTangent*o?h.tangentImpulse=0:(M=h.tangentImpulse,h.tangentImpulse=R.clamp(h.tangentImpulse+A,-P,P),A=h.tangentImpulse-M),n.x=f.x*b+y.x*A,n.y=f.y*b+y.y*A,p.isStatic||p.isSleeping||(p.positionPrev.x+=n.x*p.inverseMass,p.positionPrev.y+=n.y*p.inverseMass,p.anglePrev+=T.cross(w,n)*p.inverseInertia),m.isStatic||m.isSleeping||(m.positionPrev.x-=n.x*m.inverseMass,m.positionPrev.y-=n.y*m.inverseMass,m.anglePrev-=T.cross(S,n)*m.inverseInertia)}}}}},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(e,t,o){var c={};t.exports=c;var d=e("../geometry/Vertices"),u=e("../geometry/Vector");c.collides=function(e,t,o){var n,i,r=!1;if(i=o?(n=e.parent,i=t.parent,i=n.speed*n.speed+n.angularSpeed*n.angularSpeed+i.speed*i.speed+i.angularSpeed*i.angularSpeed,r=o&&o.collided&&i<.2,o):{collided:!1,bodyA:e,bodyB:t},o&&r){var s=i.axisBody,a=[s.axes[o.axisNumber]],s=c._overlapAxes(s.vertices,(s===e?t:e).vertices,a);if(i.reused=!0,s.overlap<=0)return i.collided=!1,i}else{if((a=c._overlapAxes(e.vertices,t.vertices,e.axes)).overlap<=0)return i.collided=!1,i;if((l=c._overlapAxes(t.vertices,e.vertices,t.axes)).overlap<=0)return i.collided=!1,i;a.overlap<l.overlap?(s=a,i.axisBody=e):(s=l,i.axisBody=t),i.axisNumber=s.axisNumber}i.bodyA=e.id<t.id?e:t,i.bodyB=e.id<t.id?t:e,i.collided=!0,i.depth=s.overlap,i.parentA=i.bodyA.parent,i.parentB=i.bodyB.parent,e=i.bodyA,t=i.bodyB,u.dot(s.axis,u.sub(t.position,e.position))<0?i.normal={x:s.axis.x,y:s.axis.y}:i.normal={x:-s.axis.x,y:-s.axis.y},i.tangent=u.perp(i.normal),i.penetration=i.penetration||{},i.penetration.x=i.normal.x*i.depth,i.penetration.y=i.normal.y*i.depth;var l=c._findSupports(e,t,i.normal),s=[];return d.contains(e.vertices,l[0])&&s.push(l[0]),d.contains(e.vertices,l[1])&&s.push(l[1]),s.length<2&&(e=c._findSupports(t,e,u.neg(i.normal)),d.contains(t.vertices,e[0])&&s.push(e[0]),s.length<2&&d.contains(t.vertices,e[1])&&s.push(e[1])),s.length<1&&(s=[l[0]]),i.supports=s,i},c._overlapAxes=function(e,t,o){for(var n,i,r=u._temp[0],s=u._temp[1],a={overlap:Number.MAX_VALUE},l=0;l<o.length;l++){if(i=o[l],c._projectToAxis(r,e,i),c._projectToAxis(s,t,i),(n=Math.min(r.max-s.min,s.max-r.min))<=0)return a.overlap=n,a;n<a.overlap&&(a.overlap=n,a.axis=i,a.axisNumber=l)}return a},c._projectToAxis=function(e,t,o){for(var n=u.dot(t[0],o),i=n,r=1;r<t.length;r+=1){var s=u.dot(t[r],o);i<s?i=s:s<n&&(n=s)}e.min=n,e.max=i},c._findSupports=function(e,t,o){for(var n,i,r,s=Number.MAX_VALUE,a=u._temp[0],l=t.vertices,c=e.position,d=0;d<l.length;d++)i=l[d],a.x=i.x-c.x,a.y=i.y-c.y,(n=-u.dot(o,a))<s&&(s=n,r=i);return i=l[0<=r.index-1?r.index-1:l.length-1],a.x=i.x-c.x,a.y=i.y-c.y,s=-u.dot(o,a),e=i,i=l[(r.index+1)%l.length],a.x=i.x-c.x,a.y=i.y-c.y,[r,e=(n=-u.dot(o,a))<s?i:e]}},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(e,t,o){var f={};t.exports=f;var s=e("../geometry/Vertices"),y=e("../geometry/Vector"),a=e("../core/Sleeping"),l=e("../geometry/Bounds"),c=e("../geometry/Axes"),n=e("../core/Common");f._warming=.4,f._torqueDampen=1,f._minLength=1e-6,f.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var o=t.bodyA?y.add(t.bodyA.position,t.pointA):t.pointA,e=t.bodyB?y.add(t.bodyB.position,t.pointB):t.pointB,e=y.magnitude(y.sub(o,e));t.length=void 0!==t.length?t.length:e,t.id=t.id||n.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(0<t.length?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};e={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&.1<t.stiffness?(e.type="pin",e.anchors=!1):t.stiffness<.9&&(e.type="spring"),t.render=n.extend(e,t.render),t},f.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var o=e[t],n=o.constraintImpulse;o.isStatic||0===n.x&&0===n.y&&0===n.angle||(o.position.x+=n.x,o.position.y+=n.y,o.angle+=n.angle)}},f.solveAll=function(e,t){for(var o=0;o<e.length;o+=1){var n=e[o],i=!n.bodyA||n.bodyA&&n.bodyA.isStatic,r=!n.bodyB||n.bodyB&&n.bodyB.isStatic;(i||r)&&f.solve(e[o],t)}for(o=0;o<e.length;o+=1)i=!(n=e[o]).bodyA||n.bodyA&&n.bodyA.isStatic,r=!n.bodyB||n.bodyB&&n.bodyB.isStatic,i||r||f.solve(e[o],t)},f.solve=function(e,t){var o,n,i,r,s,a,l,c,d=e.bodyA,u=e.bodyB,p=e.pointA,m=e.pointB;(d||u)&&(d&&!d.isStatic&&(y.rotate(p,d.angle-e.angleA,p),e.angleA=d.angle),u&&!u.isStatic&&(y.rotate(m,u.angle-e.angleB,m),e.angleB=u.angle),s=p,a=m,d&&(s=y.add(d.position,p)),u&&(a=y.add(u.position,m)),s&&a&&(o=y.sub(s,a),s=((n=(n=y.magnitude(o))<f._minLength?f._minLength:n)-e.length)/n,a=e.stiffness<1?e.stiffness*t:e.stiffness,t=y.mult(o,s*a),a=(s=(d?d.inverseMass:0)+(u?u.inverseMass:0))+((d?d.inverseInertia:0)+(u?u.inverseInertia:0)),e.damping&&(c=y.create(),l=y.div(o,n),c=y.sub(u&&y.sub(u.position,u.positionPrev)||c,d&&y.sub(d.position,d.positionPrev)||c),c=y.dot(l,c)),d&&!d.isStatic&&(r=d.inverseMass/s,d.constraintImpulse.x-=t.x*r,d.constraintImpulse.y-=t.y*r,d.position.x-=t.x*r,d.position.y-=t.y*r,e.damping&&(d.positionPrev.x-=e.damping*l.x*c*r,d.positionPrev.y-=e.damping*l.y*c*r),i=y.cross(p,t)/a*f._torqueDampen*d.inverseInertia*(1-e.angularStiffness),d.constraintImpulse.angle-=i,d.angle-=i),u&&!u.isStatic&&(r=u.inverseMass/s,u.constraintImpulse.x+=t.x*r,u.constraintImpulse.y+=t.y*r,u.position.x+=t.x*r,u.position.y+=t.y*r,e.damping&&(u.positionPrev.x+=e.damping*l.x*c*r,u.positionPrev.y+=e.damping*l.y*c*r),i=y.cross(m,t)/a*f._torqueDampen*u.inverseInertia*(1-e.angularStiffness),u.constraintImpulse.angle+=i,u.angle+=i)))},f.postSolveAll=function(e){for(var t=0;t<e.length;t++){var o=e[t],n=o.constraintImpulse;if(!(o.isStatic||0===n.x&&0===n.y&&0===n.angle)){a.set(o,!1);for(var i=0;i<o.parts.length;i++){var r=o.parts[i];s.translate(r.vertices,n),0<i&&(r.position.x+=n.x,r.position.y+=n.y),0!==n.angle&&(s.rotate(r.vertices,n.angle,o.position),c.rotate(r.axes,n.angle),0<i&&y.rotateAbout(r.position,n.angle,o.position,r.position)),l.update(r.bounds,r.vertices,o.velocity)}n.angle*=f._warming,n.x*=f._warming,n.y*=f._warming}}}},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(e,t,o){var i={};t.exports=i;var l=e("../geometry/Vertices"),c=e("../core/Sleeping"),r=e("../core/Mouse"),d=e("../core/Events"),u=e("../collision/Detector"),s=e("./Constraint"),a=e("../body/Composite"),p=e("../core/Common"),m=e("../geometry/Bounds");i.create=function(t,e){var o=(t?t.mouse:null)||(e?e.mouse:null);o||(t&&t.render&&t.render.canvas?o=r.create(t.render.canvas):e&&e.element?o=r.create(e.element):(o=r.create(),p.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var o={type:"mouseConstraint",mouse:o,element:null,body:null,constraint:s.create({label:"Mouse Constraint",pointA:o.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},n=p.extend(o,e);return d.on(t,"beforeUpdate",function(){var e=a.allBodies(t.world);i.update(n,e),i._triggerEvents(n)}),n},i.update=function(e,t){var o=e.mouse,n=e.constraint,i=e.body;if(0===o.button){if(n.bodyB)c.set(n.bodyB,!1),n.pointA=o.position;else for(var r=0;r<t.length;r++)if(i=t[r],m.contains(i.bounds,o.position)&&u.canCollide(i.collisionFilter,e.collisionFilter))for(var s=1<i.parts.length?1:0;s<i.parts.length;s++){var a=i.parts[s];if(l.contains(a.vertices,o.position)){n.pointA=o.position,n.bodyB=e.body=i,n.pointB={x:o.position.x-i.position.x,y:o.position.y-i.position.y},n.angleB=i.angle,c.set(i,!1),d.trigger(e,"startdrag",{mouse:o,body:i});break}}}else n.bodyB=e.body=null,n.pointB=null,i&&d.trigger(e,"enddrag",{mouse:o,body:i})},i._triggerEvents=function(e){var t=e.mouse,o=t.sourceEvents;o.mousemove&&d.trigger(e,"mousemove",{mouse:t}),o.mousedown&&d.trigger(e,"mousedown",{mouse:t}),o.mouseup&&d.trigger(e,"mouseup",{mouse:t}),r.clearSourceEvents(t)}},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(i,e,t){!function(n){var l={};e.exports=l,function(){l._nextId=0,l._seed=0,l._nowStartTime=+new Date,l.extend=function(e,t){for(var o,n="boolean"==typeof t?(o=2,t):(o=1,!0),i=o;i<arguments.length;i++){var r=arguments[i];if(r)for(var s in r)!n||!r[s]||r[s].constructor!==Object||e[s]&&e[s].constructor!==Object?e[s]=r[s]:(e[s]=e[s]||{},l.extend(e[s],n,r[s]))}return e},l.clone=function(e,t){return l.extend({},t,e)},l.keys=function(e){if(Object.keys)return Object.keys(e);var t,o=[];for(t in e)o.push(t);return o},l.values=function(e){var t,o=[];if(Object.keys){for(var n=Object.keys(e),i=0;i<n.length;i++)o.push(e[n[i]]);return o}for(t in e)o.push(e[t]);return o},l.get=function(e,t,o,n){t=t.split(".").slice(o,n);for(var i=0;i<t.length;i+=1)e=e[t[i]];return e},l.set=function(e,t,o,n,i){i=t.split(".").slice(n,i);return l.get(e,t,0,-1)[i[i.length-1]]=o},l.shuffle=function(e){for(var t=e.length-1;0<t;t--){var o=Math.floor(l.random()*(t+1)),n=e[t];e[t]=e[o],e[o]=n}return e},l.choose=function(e){return e[Math.floor(l.random()*e.length)]},l.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},l.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},l.isFunction=function(e){return"function"==typeof e},l.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},l.isString=function(e){return"[object String]"===toString.call(e)},l.clamp=function(e,t,o){return e<t?t:o<e?o:e},l.sign=function(e){return e<0?-1:1},l.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-l._nowStartTime},l.random=function(e,t){return t=void 0!==t?t:1,(e=void 0!==e?e:0)+o()*(t-e)};var o=function(){return l._seed=(9301*l._seed+49297)%233280,l._seed/233280};l.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},l.logLevel=1,l.log=function(){console&&0<l.logLevel&&l.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.info=function(){console&&0<l.logLevel&&l.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.warn=function(){console&&0<l.logLevel&&l.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.nextId=function(){return l._nextId++},l.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var o=0;o<e.length;o++)if(e[o]===t)return o;return-1},l.map=function(e,t){if(e.map)return e.map(t);for(var o=[],n=0;n<e.length;n+=1)o.push(t(e[n]));return o},l.topologicalSort=function(e){var t,o=[],n=[],i=[];for(t in e)n[t]||i[t]||l._topologicalSort(t,n,i,e,o);return o},l._topologicalSort=function(e,t,o,n,i){var r=n[e]||[];o[e]=!0;for(var s=0;s<r.length;s+=1){var a=r[s];o[a]||t[a]||l._topologicalSort(a,t,o,n,i)}o[e]=!1,t[e]=!0,i.push(e)},l.chain=function(){for(var r=[],e=0;e<arguments.length;e+=1){var t=arguments[e];t._chained?r.push.apply(r,t._chained):r.push(t)}function o(){for(var e,t=new Array(arguments.length),o=0,n=arguments.length;o<n;o++)t[o]=arguments[o];for(o=0;o<r.length;o+=1){var i=r[o].apply(e,t);void 0!==i&&(e=i)}return e}return o._chained=r,o},l.chainPathBefore=function(e,t,o){return l.set(e,t,l.chain(o,l.get(e,t)))},l.chainPathAfter=function(e,t,o){return l.set(e,t,l.chain(l.get(e,t),o))},l._requireGlobal=function(e,t){return("undefined"!=typeof window?window[e]:void 0!==n?n[e]:null)||i(t)}}()}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(e,t,o){var p={};t.exports=p;var n=e("../body/World"),m=e("./Sleeping"),f=e("../collision/Resolver"),i=e("../render/Render"),y=e("../collision/Pairs"),r=(e("./Metrics"),e("../collision/Grid")),v=e("./Events"),g=e("../body/Composite"),x=e("../constraint/Constraint"),s=e("./Common"),a=e("../body/Body");p.create=function(e,t){t=(s.isElement(e)?t:e)||{},((e=s.isElement(e)?e:null)||t.render)&&s.warn("Engine.create: engine.render is deprecated (see docs)");var o=s.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:r}},t);return(e||o.render)&&(o.render=s.extend({element:e,controller:i},o.render)),o.render&&o.render.controller&&(o.render=o.render.controller.create(o.render)),o.render&&(o.render.engine=o),o.world=t.world||n.create(o.world),o.pairs=y.create(),o.broadphase=o.broadphase.controller.create(o.broadphase),o.metrics=o.metrics||{extended:!1},o},p.update=function(e,t,o){o=o||1;var n,i=e.world,r=e.timing,s=e.broadphase,a=[];r.timestamp+=(t=t||1e3/60)*r.timeScale;var l={timestamp:r.timestamp};v.trigger(e,"beforeUpdate",l);var c=g.allBodies(i),d=g.allConstraints(i);for(e.enableSleeping&&m.update(c,r.timeScale),p._bodiesApplyGravity(c,i.gravity),p._bodiesUpdate(c,t,r.timeScale,o,i.bounds),x.preSolveAll(c),n=0;n<e.constraintIterations;n++)x.solveAll(d,r.timeScale);x.postSolveAll(c),a=s.controller?(i.isModified&&s.controller.clear(s),s.controller.update(s,c,e,i.isModified),s.pairsList):c,i.isModified&&g.setModified(i,!1,!1,!0);var s=s.detector(a,e),u=e.pairs,a=r.timestamp;for(y.update(u,s,a),y.removeOld(u,a),e.enableSleeping&&m.afterCollisions(u.list,r.timeScale),0<u.collisionStart.length&&v.trigger(e,"collisionStart",{pairs:u.collisionStart}),f.preSolvePosition(u.list),n=0;n<e.positionIterations;n++)f.solvePosition(u.list,r.timeScale);for(f.postSolvePosition(c),x.preSolveAll(c),n=0;n<e.constraintIterations;n++)x.solveAll(d,r.timeScale);for(x.postSolveAll(c),f.preSolveVelocity(u.list),n=0;n<e.velocityIterations;n++)f.solveVelocity(u.list,r.timeScale);return 0<u.collisionActive.length&&v.trigger(e,"collisionActive",{pairs:u.collisionActive}),0<u.collisionEnd.length&&v.trigger(e,"collisionEnd",{pairs:u.collisionEnd}),p._bodiesClearForces(c),v.trigger(e,"afterUpdate",l),e},p.merge=function(e,t){if(s.extend(e,t),t.world){e.world=t.world,p.clear(e);for(var o=g.allBodies(e.world),n=0;n<o.length;n++){var i=o[n];m.set(i,!1),i.id=s.nextId()}}},p.clear=function(e){var t=e.world;y.clear(e.pairs);var o=e.broadphase;o.controller&&(t=g.allBodies(t),o.controller.clear(o),o.controller.update(o,t,e,!0))},p._bodiesClearForces=function(e){for(var t=0;t<e.length;t++){var o=e[t];o.force.x=0,o.force.y=0,o.torque=0}},p._bodiesApplyGravity=function(e,t){var o=void 0!==t.scale?t.scale:.001;if((0!==t.x||0!==t.y)&&0!==o)for(var n=0;n<e.length;n++){var i=e[n];i.isStatic||i.isSleeping||(i.force.y+=i.mass*t.y*o,i.force.x+=i.mass*t.x*o)}},p._bodiesUpdate=function(e,t,o,n,i){for(var r=0;r<e.length;r++){var s=e[r];s.isStatic||s.isSleeping||a.update(s,t,o,n)}}},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(e,t,o){var n={};t.exports=n;var c=e("./Common");n.on=function(e,t,o){for(var n,i=t.split(" "),r=0;r<i.length;r++)n=i[r],e.events=e.events||{},e.events[n]=e.events[n]||[],e.events[n].push(o);return o},n.off=function(e,t,o){if(t){"function"==typeof t&&(o=t,t=c.keys(e.events).join(" "));for(var n=t.split(" "),i=0;i<n.length;i++){var r=e.events[n[i]],s=[];if(o&&r)for(var a=0;a<r.length;a++)r[a]!==o&&s.push(r[a]);e.events[n[i]]=s}}else e.events={}},n.trigger=function(e,t,o){var n,i,r;if(e.events){o=o||{};for(var s=t.split(" "),a=0;a<s.length;a++)if(n=s[a],i=e.events[n]){(r=c.clone(o,!1)).name=n,r.source=e;for(var l=0;l<i.length;l++)i[l].apply(e,[r])}}}},{"./Common":14}],17:[function(e,t,o){var n={};t.exports=n;var i=e("./Plugin"),r=e("./Common");n.name="matter-js",n.version="0.14.2",n.uses=[],n.used=[],n.use=function(){i.use(n,Array.prototype.slice.call(arguments))},n.before=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathBefore(n,e,t)},n.after=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathAfter(n,e,t)}},{"./Common":14,"./Plugin":20}],18:[function(e,t,o){},{"../body/Composite":2,"./Common":14}],19:[function(e,t,o){var n={};t.exports=n;var i=e("../core/Common");n.create=function(e){var o={};return e||i.log("Mouse.create: element was undefined, defaulting to document.body","warn"),o.element=e||document.body,o.absolute={x:0,y:0},o.position={x:0,y:0},o.mousedownPosition={x:0,y:0},o.mouseupPosition={x:0,y:0},o.offset={x:0,y:0},o.scale={x:1,y:1},o.wheelDelta=0,o.button=-1,o.pixelRatio=o.element.getAttribute("data-pixel-ratio")||1,o.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},o.mousemove=function(e){var t=n._getRelativeMousePosition(e,o.element,o.pixelRatio);e.changedTouches&&(o.button=0,e.preventDefault()),o.absolute.x=t.x,o.absolute.y=t.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.sourceEvents.mousemove=e},o.mousedown=function(e){var t=n._getRelativeMousePosition(e,o.element,o.pixelRatio);e.changedTouches?(o.button=0,e.preventDefault()):o.button=e.button,o.absolute.x=t.x,o.absolute.y=t.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.mousedownPosition.x=o.position.x,o.mousedownPosition.y=o.position.y,o.sourceEvents.mousedown=e},o.mouseup=function(e){var t=n._getRelativeMousePosition(e,o.element,o.pixelRatio);e.changedTouches&&e.preventDefault(),o.button=-1,o.absolute.x=t.x,o.absolute.y=t.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.mouseupPosition.x=o.position.x,o.mouseupPosition.y=o.position.y,o.sourceEvents.mouseup=e},o.mousewheel=function(e){o.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},n.setElement(o,o.element),o},n.setElement=function(e,t){(e.element=t).addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},n.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},n.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},n.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},n._getRelativeMousePosition=function(e,t,o){var n,i=t.getBoundingClientRect(),r=document.documentElement||document.body.parentNode||document.body,s=void 0!==window.pageXOffset?window.pageXOffset:r.scrollLeft,a=void 0!==window.pageYOffset?window.pageYOffset:r.scrollTop,r=e.changedTouches,a=r?(n=r[0].pageX-i.left-s,r[0].pageY-i.top-a):(n=e.pageX-i.left-s,e.pageY-i.top-a);return{x:n/(t.clientWidth/(t.width||t.clientWidth)*o),y:a/(t.clientHeight/(t.height||t.clientHeight)*o)}}},{"../core/Common":14}],20:[function(e,t,o){var s={};t.exports=s;var a=e("./Common");s._registry={},s.register=function(e){var t,o,n;return s.isPlugin(e)||a.warn("Plugin.register:",s.toString(e),"does not implement all required fields."),e.name in s._registry?(t=s._registry[e.name],o=s.versionParse(e.version).number,(n=s.versionParse(t.version).number)<o?(a.warn("Plugin.register:",s.toString(t),"was upgraded to",s.toString(e)),s._registry[e.name]=e):o<n?a.warn("Plugin.register:",s.toString(t),"can not be downgraded to",s.toString(e)):e!==t&&a.warn("Plugin.register:",s.toString(e),"is already registered to different plugin object")):s._registry[e.name]=e,e},s.resolve=function(e){return s._registry[s.dependencyParse(e).name]},s.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},s.isPlugin=function(e){return e&&e.name&&e.version&&e.install},s.isUsed=function(e,t){return-1<e.used.indexOf(t)},s.isFor=function(e,t){var o=e.for&&s.dependencyParse(e.for);return!e.for||t.name===o.name&&s.versionSatisfies(t.version,o.range)},s.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var o,t=s.dependencies(e),n=a.topologicalSort(t),i=[],r=0;r<n.length;r+=1)n[r]!==e.name&&((o=s.resolve(n[r]))?s.isUsed(e,o.name)||(s.isFor(o,e)||(a.warn("Plugin.use:",s.toString(o),"is for",o.for,"but installed on",s.toString(e)+"."),o._warned=!0),o.install?o.install(e):(a.warn("Plugin.use:",s.toString(o),"does not specify an install function."),o._warned=!0),o._warned?(i.push("🔶 "+s.toString(o)),delete o._warned):i.push("✅ "+s.toString(o)),e.used.push(o.name)):i.push("❌ "+n[r]));0<i.length&&a.info(i.join("  "))}else a.warn("Plugin.use:",s.toString(e),"does not specify any dependencies to install.")},s.dependencies=function(n,e){var i=s.dependencyParse(n),t=i.name;if(!(t in(e=e||{}))){n=s.resolve(n)||n,e[t]=a.map(n.uses||[],function(e){s.isPlugin(e)&&s.register(e);var t=s.dependencyParse(e),o=s.resolve(e);return o&&!s.versionSatisfies(o.version,t.range)?(a.warn("Plugin.dependencies:",s.toString(o),"does not satisfy",s.toString(t),"used by",s.toString(i)+"."),o._warned=!0,n._warned=!0):o||(a.warn("Plugin.dependencies:",s.toString(e),"used by",s.toString(i),"could not be resolved."),n._warned=!0),t.name});for(var o=0;o<e[t].length;o+=1)s.dependencies(e[t][o],e);return e}},s.dependencyParse=function(e){return a.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(e)||a.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},s.versionParse=function(e){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(e)||a.warn("Plugin.versionParse:",e,"is not a valid version or range.");var t=e.split("-");e=t[0];var o=isNaN(Number(e[0])),n=o?e.substr(1):e,i=a.map(n.split("."),function(e){return Number(e)});return{isRange:o,version:n,range:e,operator:o?e[0]:"",parts:i,prerelease:t[1],number:1e8*i[0]+1e4*i[1]+i[2]}},s.versionSatisfies=function(e,t){var o=s.versionParse(t=t||"*"),n=o.parts,i=s.versionParse(e),r=i.parts;if(o.isRange){if("*"===o.operator||"*"===e)return!0;if("~"===o.operator)return r[0]===n[0]&&r[1]===n[1]&&r[2]>=n[2];if("^"===o.operator)return 0<n[0]?r[0]===n[0]&&i.number>=o.number:0<n[1]?r[1]===n[1]&&r[2]>=n[2]:r[2]===n[2]}return e===t||"*"===e}},{"./Common":14}],21:[function(e,t,o){var i={};t.exports=i;var r,n,s,a=e("./Events"),l=e("./Engine"),c=e("./Common");"undefined"!=typeof window&&(r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r||(r=function(e){s=setTimeout(function(){e(c.now())},1e3/60)},n=function(){clearTimeout(s)}),i.create=function(e){e=c.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return e.delta=e.delta||1e3/e.fps,e.deltaMin=e.deltaMin||1e3/e.fps,e.deltaMax=e.deltaMax||1e3/(.5*e.fps),e.fps=1e3/e.delta,e},i.run=function(o,n){return void 0!==o.positionIterations&&(n=o,o=i.create()),function e(t){o.frameRequestId=r(e),t&&o.enabled&&i.tick(o,n,t)}(),o},i.tick=function(e,t,o){var n,i=t.timing,r=1,s={timestamp:i.timestamp};a.trigger(e,"beforeTick",s),a.trigger(t,"beforeTick",s),e.isFixed?n=e.delta:(n=o-e.timePrev||e.delta,e.timePrev=o,e.deltaHistory.push(n),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),r=(n=(n=(n=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:n)>e.deltaMax?e.deltaMax:n)/e.delta,e.delta=n),0!==e.timeScalePrev&&(r*=i.timeScale/e.timeScalePrev),0===i.timeScale&&(r=0),e.timeScalePrev=i.timeScale,e.correction=r,e.frameCounter+=1,1e3<=o-e.counterTimestamp&&(e.fps=e.frameCounter*((o-e.counterTimestamp)/1e3),e.counterTimestamp=o,e.frameCounter=0),a.trigger(e,"tick",s),a.trigger(t,"tick",s),t.world.isModified&&t.render&&t.render.controller&&t.render.controller.clear&&t.render.controller.clear(t.render),a.trigger(e,"beforeUpdate",s),l.update(t,n,r),a.trigger(e,"afterUpdate",s),t.render&&t.render.controller&&(a.trigger(e,"beforeRender",s),a.trigger(t,"beforeRender",s),t.render.controller.world(t.render),a.trigger(e,"afterRender",s),a.trigger(t,"afterRender",s)),a.trigger(e,"afterTick",s),a.trigger(t,"afterTick",s)},i.stop=function(e){n(e.frameRequestId)},i.start=function(e,t){i.run(e,t)}},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(e,t,o){var a={};t.exports=a;var n=e("./Events");a._motionWakeThreshold=.18,a._motionSleepThreshold=.08,a._minBias=.9,a.update=function(e,t){for(var o=t*t*t,n=0;n<e.length;n++){var i,r=e[n],s=r.speed*r.speed+r.angularSpeed*r.angularSpeed;0===r.force.x&&0===r.force.y?(i=Math.min(r.motion,s),s=Math.max(r.motion,s),r.motion=a._minBias*i+(1-a._minBias)*s,0<r.sleepThreshold&&r.motion<a._motionSleepThreshold*o?(r.sleepCounter+=1,r.sleepCounter>=r.sleepThreshold&&a.set(r,!0)):0<r.sleepCounter&&--r.sleepCounter):a.set(r,!1)}},a.afterCollisions=function(e,t){for(var o=t*t*t,n=0;n<e.length;n++){var i,r,s=e[n];s.isActive&&(i=(r=s.collision).bodyA.parent,s=r.bodyB.parent,i.isSleeping&&s.isSleeping||i.isStatic||s.isStatic||!i.isSleeping&&!s.isSleeping||!(r=i.isSleeping&&!i.isStatic?i:s).isStatic&&(r===i?s:i).motion>a._motionWakeThreshold*o&&a.set(r,!1))}},a.set=function(e,t){var o=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,o||n.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,o&&n.trigger(e,"sleepEnd"))}},{"./Events":16}],23:[function(e,t,o){var u={};t.exports=u;var C,A=e("../geometry/Vertices"),P=e("../core/Common"),B=e("../body/Body"),M=e("../geometry/Bounds"),k=e("../geometry/Vector");u.rectangle=function(e,t,o,n,i){i=i||{};o={label:"Rectangle Body",position:{x:e,y:t},vertices:A.fromPath("L 0 0 L "+o+" 0 L "+o+" "+n+" L 0 "+n)};return i.chamfer&&(n=i.chamfer,o.vertices=A.chamfer(o.vertices,n.radius,n.quality,n.qualityMin,n.qualityMax),delete i.chamfer),B.create(P.extend({},o,i))},u.trapezoid=function(e,t,o,n,i,r){r=r||{};var s=o*(i*=.5),a=s+(1-2*i)*o,o=a+s,n={label:"Trapezoid Body",position:{x:e,y:t},vertices:A.fromPath(i<.5?"L 0 0 L "+s+" "+-n+" L "+a+" "+-n+" L "+o+" 0":"L 0 0 L "+a+" "+-n+" L "+o+" 0")};return r.chamfer&&(o=r.chamfer,n.vertices=A.chamfer(n.vertices,o.radius,o.quality,o.qualityMin,o.qualityMax),delete r.chamfer),B.create(P.extend({},n,r))},u.circle=function(e,t,o,n,i){n=n||{};var r={label:"Circle Body",circleRadius:o};i=i||25;i=Math.ceil(Math.max(10,Math.min(i,o)));return i%2==1&&(i+=1),u.polygon(e,t,i,o,P.extend({},r,n))},u.polygon=function(e,t,o,n,i){if(i=i||{},o<3)return u.circle(e,t,n,i);for(var r=2*Math.PI/o,s="",a=.5*r,l=0;l<o;l+=1){var c=a+l*r,d=Math.cos(c)*n,c=Math.sin(c)*n;s+="L "+d.toFixed(3)+" "+c.toFixed(3)+" "}e={label:"Polygon Body",position:{x:e,y:t},vertices:A.fromPath(s)};return i.chamfer&&(t=i.chamfer,e.vertices=A.chamfer(e.vertices,t.radius,t.quality,t.qualityMin,t.qualityMax),delete i.chamfer),B.create(P.extend({},e,i))},u.fromVertices=function(e,t,o,n,i,r,s){var a,l,c,d;for(n=n||{},a=[],i=void 0!==i&&i,r=void 0!==r?r:.01,s=void 0!==s?s:10,(C=C||P._requireGlobal("decomp","poly-decomp"))||P.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),P.isArray(o[0])||(o=[o]),c=0;c<o.length;c+=1)if(u=o[c],(l=A.isConvex(u))||!C)u=l?A.clockwiseSort(u):A.hull(u),a.push({position:{x:e,y:t},vertices:u});else{var u=u.map(function(e){return[e.x,e.y]});C.makeCCW(u),!1!==r&&C.removeCollinearPoints(u,r);for(var p=C.quickDecomp(u),m=0;m<p.length;m++){var f=p[m].map(function(e){return{x:e[0],y:e[1]}});0<s&&A.area(f)<s||a.push({position:A.centre(f),vertices:f})}}for(m=0;m<a.length;m++)a[m]=B.create(P.extend(a[m],n));if(i)for(m=0;m<a.length;m++)for(var y=a[m],v=m+1;v<a.length;v++){var g=a[v];if(M.overlaps(y.bounds,g.bounds))for(var x=y.vertices,h=g.vertices,b=0;b<y.vertices.length;b++)for(d=0;d<g.vertices.length;d++){var w=k.magnitudeSquared(k.sub(x[(b+1)%x.length],h[d])),S=k.magnitudeSquared(k.sub(x[b],h[(d+1)%h.length]));w<5&&S<5&&(x[b].isInternal=!0,h[d].isInternal=!0)}}return 1<a.length?(i=B.create(P.extend({parts:a.slice(0)},n)),B.setPosition(i,{x:e,y:t}),i):a[0]}},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(e,t,o){var m={};t.exports=m;var x=e("../body/Composite"),f=e("../constraint/Constraint"),y=e("../core/Common"),h=e("../body/Body"),d=e("./Bodies");m.stack=function(e,t,o,n,i,r,s){for(var a,l=x.create({label:"Stack"}),c=e,d=t,u=0,p=0;p<n;p++){for(var m=0,f=0;f<o;f++){var y,v,g=s(c,d,f,p,a,u);g?(y=g.bounds.max.y-g.bounds.min.y,v=g.bounds.max.x-g.bounds.min.x,m<y&&(m=y),h.translate(g,{x:.5*v,y:.5*y}),c=g.bounds.max.x+i,x.addBody(l,g),a=g,u+=1):c+=i}d+=m+r,c=e}return l},m.chain=function(e,t,o,n,i,r){for(var s=e.bodies,a=1;a<s.length;a++){var l=s[a-1],c=s[a],d=l.bounds.max.y-l.bounds.min.y,u=l.bounds.max.x-l.bounds.min.x,p=c.bounds.max.y-c.bounds.min.y,p={bodyA:l,pointA:{x:u*t,y:d*o},bodyB:c,pointB:{x:(c.bounds.max.x-c.bounds.min.x)*n,y:p*i}},p=y.extend(p,r);x.addConstraint(e,f.create(p))}return e.label+=" Chain",e},m.mesh=function(e,t,o,n,i){for(var r,s,a,l,c=e.bodies,d=0;d<o;d++){for(r=1;r<t;r++)s=c[r-1+d*t],a=c[r+d*t],x.addConstraint(e,f.create(y.extend({bodyA:s,bodyB:a},i)));if(0<d)for(r=0;r<t;r++)s=c[r+(d-1)*t],a=c[r+d*t],x.addConstraint(e,f.create(y.extend({bodyA:s,bodyB:a},i))),n&&0<r&&(l=c[r-1+(d-1)*t],x.addConstraint(e,f.create(y.extend({bodyA:l,bodyB:a},i)))),n&&r<t-1&&(l=c[r+1+(d-1)*t],x.addConstraint(e,f.create(y.extend({bodyA:l,bodyB:a},i))))}return e.label+=" Mesh",e},m.pyramid=function(l,e,c,d,u,t,p){return m.stack(l,e,c,d,u,t,function(e,t,o,n,i,r){var s=Math.min(d,Math.ceil(c/2)),a=i?i.bounds.max.x-i.bounds.min.x:0;if(!(s<n||o<(n=s-n)||c-1-n<o))return 1===r&&h.translate(i,{x:(o+(c%2==1?1:-1))*a,y:0}),p(l+(i?o*a:0)+o*u,t,o,n,i,r)})},m.newtonsCradle=function(e,t,o,n,i){for(var r=x.create({label:"Newtons Cradle"}),s=0;s<o;s++){var a=d.circle(e+s*(1.9*n),t+i,n,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),l=f.create({pointA:{x:e+s*(1.9*n),y:t},bodyB:a});x.addBody(r,a),x.addConstraint(r,l)}return r},m.car=function(e,t,o,n,i){var r=h.nextGroup(!0),s=.5*-o+20,a=.5*o-20,l=x.create({label:"Car"}),o=d.rectangle(e,t,o,n,{collisionFilter:{group:r},chamfer:{radius:.5*n},density:2e-4}),n=d.circle(e+s,t+0,i,{collisionFilter:{group:r},friction:.8}),r=d.circle(e+a,t+0,i,{collisionFilter:{group:r},friction:.8}),s=f.create({bodyB:o,pointB:{x:s,y:0},bodyA:n,stiffness:1,length:0}),a=f.create({bodyB:o,pointB:{x:a,y:0},bodyA:r,stiffness:1,length:0});return x.addBody(l,o),x.addBody(l,n),x.addBody(l,r),x.addConstraint(l,s),x.addConstraint(l,a),l},m.softBody=function(e,t,o,n,i,r,s,a,l,c){l=y.extend({inertia:1/0},l),c=y.extend({stiffness:.2,render:{type:"line",anchors:!1}},c);r=m.stack(e,t,o,n,i,r,function(e,t){return d.circle(e,t,a,l)});return m.mesh(r,o,n,s,c),r.label="Soft Body",r}},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(e,t,o){var n={};t.exports=n;var i=e("../geometry/Vector"),r=e("../core/Common");n.fromVertices=function(e){for(var t={},o=0;o<e.length;o++){var n=(o+1)%e.length,n=i.normalise({x:e[n].y-e[o].y,y:e[o].x-e[n].x});t[(0===n.y?1/0:n.x/n.y).toFixed(3).toString()]=n}return r.values(t)},n.rotate=function(e,t){if(0!==t)for(var o=Math.cos(t),n=Math.sin(t),i=0;i<e.length;i++){var r=e[i],s=r.x*o-r.y*n;r.y=r.x*n+r.y*o,r.x=s}}},{"../core/Common":14,"../geometry/Vector":28}],26:[function(e,t,o){var n={};(t.exports=n).create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&n.update(t,e),t},n.update=function(e,t,o){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var n=0;n<t.length;n++){var i=t[n];i.x>e.max.x&&(e.max.x=i.x),i.x<e.min.x&&(e.min.x=i.x),i.y>e.max.y&&(e.max.y=i.y),i.y<e.min.y&&(e.min.y=i.y)}o&&(0<o.x?e.max.x+=o.x:e.min.x+=o.x,0<o.y?e.max.y+=o.y:e.min.y+=o.y)},n.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},n.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},n.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},n.shift=function(e,t){var o=e.max.x-e.min.x,n=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+o,e.min.y=t.y,e.max.y=t.y+n}},{}],27:[function(e,t,o){var h={};t.exports=h,e("../geometry/Bounds");var b=e("../core/Common");h.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||b.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var o,n,i,r,s,a,l,c,d,u,p,m=[],f=0,y=0,v=0;t=t||15;function g(e,t,o){var n=o%2==1&&1<o;d&&e==d.x&&t==d.y||(p=d&&n?(u=d.x,d.y):u=0,o={x:u+e,y:p+t},!n&&d||(d=o),m.push(o),y=u+e,v=p+t)}function x(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":y=e.x,v=e.y;break;case"H":y=e.x;break;case"V":v=e.y}g(y,v,e.pathSegType)}}for(h._svgPathToAbsolute(e),i=e.getTotalLength(),a=[],o=0;o<e.pathSegList.numberOfItems;o+=1)a.push(e.pathSegList.getItem(o));for(l=a.concat();f<i;){if((s=a[e.getPathSegAtLength(f)])!=c){for(;l.length&&l[0]!=s;)x(l.shift());c=s}switch(s.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":r=e.getPointAtLength(f),g(r.x,r.y,0)}f+=t}for(o=0,n=l.length;o<n;++o)x(l[o]);return m},h._svgPathToAbsolute=function(e){for(var t,o,n,i,r,s,a=e.pathSegList,l=0,c=0,d=a.numberOfItems,u=0;u<d;++u){var p=a.getItem(u),m=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(m))"x"in p&&(l=p.x),"y"in p&&(c=p.y);else switch("x1"in p&&(n=l+p.x1),"x2"in p&&(r=l+p.x2),"y1"in p&&(i=c+p.y1),"y2"in p&&(s=c+p.y2),"x"in p&&(l+=p.x),"y"in p&&(c+=p.y),m){case"m":a.replaceItem(e.createSVGPathSegMovetoAbs(l,c),u);break;case"l":a.replaceItem(e.createSVGPathSegLinetoAbs(l,c),u);break;case"h":a.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(l),u);break;case"v":a.replaceItem(e.createSVGPathSegLinetoVerticalAbs(c),u);break;case"c":a.replaceItem(e.createSVGPathSegCurvetoCubicAbs(l,c,n,i,r,s),u);break;case"s":a.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(l,c,r,s),u);break;case"q":a.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(l,c,n,i),u);break;case"t":a.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(l,c),u);break;case"a":a.replaceItem(e.createSVGPathSegArcAbs(l,c,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),u);break;case"z":case"Z":l=t,c=o}"M"!=m&&"m"!=m||(t=l,o=c)}}},{"../core/Common":14,"../geometry/Bounds":26}],28:[function(e,t,o){var n={};(t.exports=n).create=function(e,t){return{x:e||0,y:t||0}},n.clone=function(e){return{x:e.x,y:e.y}},n.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},n.rotate=function(e,t,o){var n=Math.cos(t),i=Math.sin(t),t=e.x*n-e.y*i;return(o=o||{}).y=e.x*i+e.y*n,o.x=t,o},n.rotateAbout=function(e,t,o,n){var i=Math.cos(t),r=Math.sin(t),t=o.x+((e.x-o.x)*i-(e.y-o.y)*r);return(n=n||{}).y=o.y+((e.x-o.x)*r+(e.y-o.y)*i),n.x=t,n},n.normalise=function(e){var t=n.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.cross=function(e,t){return e.x*t.y-e.y*t.x},n.cross3=function(e,t,o){return(t.x-e.x)*(o.y-e.y)-(t.y-e.y)*(o.x-e.x)},n.add=function(e,t,o){return(o=o||{}).x=e.x+t.x,o.y=e.y+t.y,o},n.sub=function(e,t,o){return(o=o||{}).x=e.x-t.x,o.y=e.y-t.y,o},n.mult=function(e,t){return{x:e.x*t,y:e.y*t}},n.div=function(e,t){return{x:e.x/t,y:e.y/t}},n.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},n.neg=function(e){return{x:-e.x,y:-e.y}},n.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},{}],29:[function(e,t,o){var s={};t.exports=s;var x=e("../geometry/Vector"),h=e("../core/Common");s.create=function(e,t){for(var o=[],n=0;n<e.length;n++){var i=e[n],i={x:i.x,y:i.y,index:n,body:t,isInternal:!1};o.push(i)}return o},s.fromPath=function(e,t){var n=[];return e.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(e,t,o){n.push({x:parseFloat(t),y:parseFloat(o)})}),s.create(n,t)},s.centre=function(e){for(var t,o,n=s.area(e,!0),i={x:0,y:0},r=0;r<e.length;r++)o=(r+1)%e.length,t=x.cross(e[r],e[o]),t=x.mult(x.add(e[r],e[o]),t),i=x.add(i,t);return x.div(i,6*n)},s.mean=function(e){for(var t={x:0,y:0},o=0;o<e.length;o++)t.x+=e[o].x,t.y+=e[o].y;return x.div(t,e.length)},s.area=function(e,t){for(var o=0,n=e.length-1,i=0;i<e.length;i++)o+=(e[n].x-e[i].x)*(e[n].y+e[i].y),n=i;return t?o/2:Math.abs(o)/2},s.inertia=function(e,t){for(var o,n,i=0,r=0,s=e,a=0;a<s.length;a++)n=(a+1)%s.length,i+=(o=Math.abs(x.cross(s[n],s[a])))*(x.dot(s[n],s[n])+x.dot(s[n],s[a])+x.dot(s[a],s[a])),r+=o;return t/6*(i/r)},s.translate=function(e,t,o){var n;if(o)for(n=0;n<e.length;n++)e[n].x+=t.x*o,e[n].y+=t.y*o;else for(n=0;n<e.length;n++)e[n].x+=t.x,e[n].y+=t.y;return e},s.rotate=function(e,t,o){if(0!==t){for(var n=Math.cos(t),i=Math.sin(t),r=0;r<e.length;r++){var s=e[r],a=s.x-o.x,l=s.y-o.y;s.x=o.x+(a*n-l*i),s.y=o.y+(a*i+l*n)}return e}},s.contains=function(e,t){for(var o=0;o<e.length;o++){var n=e[o],i=e[(o+1)%e.length];if(0<(t.x-n.x)*(i.y-n.y)+(t.y-n.y)*(n.x-i.x))return!1}return!0},s.scale=function(e,t,o,n){if(1===t&&1===o)return e;var i;n=n||s.centre(e);for(var r=0;r<e.length;r++)i=e[r],i=x.sub(i,n),e[r].x=n.x+i.x*t,e[r].y=n.y+i.y*o;return e},s.chamfer=function(e,t,o,n,i){t="number"==typeof t?[t]:t||[8],o=void 0!==o?o:-1,n=n||2,i=i||14;for(var r=[],s=0;s<e.length;s++){var a=e[0<=s-1?s-1:e.length-1],l=e[s],c=e[(s+1)%e.length],d=t[s<t.length?s:t.length-1];if(0!==d){var u=x.normalise({x:l.y-a.y,y:a.x-l.x}),p=x.normalise({x:c.y-l.y,y:l.x-c.x}),a=Math.sqrt(2*Math.pow(d,2)),m=x.mult(h.clone(u),d),c=x.normalise(x.mult(x.add(u,p),.5)),f=x.sub(l,x.mult(c,a)),y=o;-1===o&&(y=1.75*Math.pow(d,.32)),(y=h.clamp(y,n,i))%2==1&&(y+=1);for(var v=Math.acos(x.dot(u,p))/y,g=0;g<y;g++)r.push(x.add(x.rotate(m,v*g),f))}else r.push(l)}return r},s.clockwiseSort=function(e){var o=s.mean(e);return e.sort(function(e,t){return x.angle(o,e)-x.angle(o,t)}),e},s.isConvex=function(e){var t,o,n,i,r=0,s=e.length;if(s<3)return null;for(t=0;t<s;t++)if(i=(e[o=(t+1)%s].x-e[t].x)*(e[n=(t+2)%s].y-e[o].y),(i-=(e[o].y-e[t].y)*(e[n].x-e[o].x))<0?r|=1:0<i&&(r|=2),3===r)return!1;return 0!==r||null},s.hull=function(e){var t,o,n=[],i=[];for((e=e.slice(0)).sort(function(e,t){var o=e.x-t.x;return 0!=o?o:e.y-t.y}),o=0;o<e.length;o+=1){for(t=e[o];2<=i.length&&x.cross3(i[i.length-2],i[i.length-1],t)<=0;)i.pop();i.push(t)}for(o=e.length-1;0<=o;--o){for(t=e[o];2<=n.length&&x.cross3(n[n.length-2],n[n.length-1],t)<=0;)n.pop();n.push(t)}return n.pop(),i.pop(),n.concat(i)}},{"../core/Common":14,"../geometry/Vector":28}],30:[function(e,t,o){t=t.exports=e("../core/Matter");t.Body=e("../body/Body"),t.Composite=e("../body/Composite"),t.World=e("../body/World"),t.Contact=e("../collision/Contact"),t.Detector=e("../collision/Detector"),t.Grid=e("../collision/Grid"),t.Pairs=e("../collision/Pairs"),t.Pair=e("../collision/Pair"),t.Query=e("../collision/Query"),t.Resolver=e("../collision/Resolver"),t.SAT=e("../collision/SAT"),t.Constraint=e("../constraint/Constraint"),t.MouseConstraint=e("../constraint/MouseConstraint"),t.Common=e("../core/Common"),t.Engine=e("../core/Engine"),t.Events=e("../core/Events"),t.Mouse=e("../core/Mouse"),t.Runner=e("../core/Runner"),t.Sleeping=e("../core/Sleeping"),t.Plugin=e("../core/Plugin"),t.Bodies=e("../factory/Bodies"),t.Composites=e("../factory/Composites"),t.Axes=e("../geometry/Axes"),t.Bounds=e("../geometry/Bounds"),t.Svg=e("../geometry/Svg"),t.Vector=e("../geometry/Vector"),t.Vertices=e("../geometry/Vertices"),t.Render=e("../render/Render"),t.RenderPixi=e("../render/RenderPixi"),t.World.add=t.Composite.add,t.World.remove=t.Composite.remove,t.World.addComposite=t.Composite.addComposite,t.World.addBody=t.Composite.addBody,t.World.addConstraint=t.Composite.addConstraint,t.World.clear=t.Composite.clear,t.Engine.run=t.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(e,t,o){var h={};t.exports=h;var f=e("../core/Common"),b=e("../body/Composite"),w=e("../geometry/Bounds"),S=e("../core/Events"),C=e("../collision/Grid"),A=e("../geometry/Vector"),P=e("../core/Mouse");!function(){var n,t;"undefined"!=typeof window&&(n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(f.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),h.create=function(e){var t={controller:h,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},t=f.extend(t,e);return t.canvas&&(t.canvas.width=t.options.width||t.canvas.width,t.canvas.height=t.options.height||t.canvas.height),t.mouse=e.mouse,t.engine=e.engine,t.canvas=t.canvas||o(t.options.width,t.options.height),t.context=t.canvas.getContext("2d"),t.textures={},t.bounds=t.bounds||{min:{x:0,y:0},max:{x:t.canvas.width,y:t.canvas.height}},1!==t.options.pixelRatio&&h.setPixelRatio(t,t.options.pixelRatio),f.isElement(t.element)?t.element.appendChild(t.canvas):t.canvas.parentNode||f.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),t},h.run=function(o){!function e(t){o.frameRequestId=n(e),h.world(o)}()},h.stop=function(e){t(e.frameRequestId)},h.setPixelRatio=function(e,t){var o=e.options,n=e.canvas;"auto"===t&&(t=i(n)),o.pixelRatio=t,n.setAttribute("data-pixel-ratio",t),n.width=o.width*t,n.height=o.height*t,n.style.width=o.width+"px",n.style.height=o.height+"px",e.context.scale(t,t)},h.lookAt=function(e,t,o,n){n=void 0===n||n,t=f.isArray(t)?t:[t],o=o||{x:0,y:0};for(var i={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},r=0;r<t.length;r+=1){var s=t[r],a=s.bounds?s.bounds.min:s.min||s.position||s,s=s.bounds?s.bounds.max:s.max||s.position||s;a&&s&&(a.x<i.min.x&&(i.min.x=a.x),s.x>i.max.x&&(i.max.x=s.x),a.y<i.min.y&&(i.min.y=a.y),s.y>i.max.y&&(i.max.y=s.y))}var l=i.max.x-i.min.x+2*o.x,c=i.max.y-i.min.y+2*o.y,d=e.canvas.height,u=e.canvas.width/d,p=l/c,m=1,d=1;u<p?d=p/u:m=u/p,e.options.hasBounds=!0,e.bounds.min.x=i.min.x,e.bounds.max.x=i.min.x+l*m,e.bounds.min.y=i.min.y,e.bounds.max.y=i.min.y+c*d,n&&(e.bounds.min.x+=.5*l-l*m*.5,e.bounds.max.x+=.5*l-l*m*.5,e.bounds.min.y+=.5*c-c*d*.5,e.bounds.max.y+=.5*c-c*d*.5),e.bounds.min.x-=o.x,e.bounds.max.x-=o.x,e.bounds.min.y-=o.y,e.bounds.max.y-=o.y,e.mouse&&(P.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),P.setOffset(e.mouse,e.bounds.min))},h.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,o=e.bounds.max.y-e.bounds.min.y,t=t/e.options.width,o=o/e.options.height;e.context.scale(1/t,1/o),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},h.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},h.world=function(e){var t,o=e.engine,n=o.world,i=e.canvas,r=e.context,s=e.options,a=b.allBodies(n),l=b.allConstraints(n),c=s.wireframes?s.wireframeBackground:s.background,d=[],u=[],n={timestamp:o.timing.timestamp};if(S.trigger(e,"beforeRender",n),e.currentBackground!==c&&x(e,c),r.globalCompositeOperation="source-in",r.fillStyle="transparent",r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="source-over",s.hasBounds){for(t=0;t<a.length;t++){var p=a[t];w.overlaps(p.bounds,e.bounds)&&d.push(p)}for(t=0;t<l.length;t++){var m=l[t],f=m.bodyA,y=m.bodyB,v=m.pointA,g=m.pointB;f&&(v=A.add(f.position,m.pointA)),y&&(g=A.add(y.position,m.pointB)),v&&g&&(w.contains(e.bounds,v)||w.contains(e.bounds,g))&&u.push(m)}h.startViewTransform(e),e.mouse&&(P.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),P.setOffset(e.mouse,e.bounds.min))}else u=l,d=a;!s.wireframes||o.enableSleeping&&s.showSleeping?h.bodies(e,d,r):(s.showConvexHulls&&h.bodyConvexHulls(e,d,r),h.bodyWireframes(e,d,r)),s.showBounds&&h.bodyBounds(e,d,r),(s.showAxes||s.showAngleIndicator)&&h.bodyAxes(e,d,r),s.showPositions&&h.bodyPositions(e,d,r),s.showVelocity&&h.bodyVelocity(e,d,r),s.showIds&&h.bodyIds(e,d,r),s.showSeparations&&h.separations(e,o.pairs.list,r),s.showCollisions&&h.collisions(e,o.pairs.list,r),s.showVertexNumbers&&h.vertexNumbers(e,d,r),s.showMousePosition&&h.mousePosition(e,e.mouse,r),h.constraints(u,r),s.showBroadphase&&o.broadphase.controller===C&&h.grid(e,o.broadphase,r),s.showDebug&&h.debug(e,r),s.hasBounds&&h.endViewTransform(e),S.trigger(e,"afterRender",n)},h.debug=function(e,t){var o=t,n=e.engine,i=n.world,r=n.metrics,t=e.options;if(b.allBodies(i),500<=n.timing.timestamp-(e.debugTimestamp||0)&&(i="",r.timing&&(i+="fps: "+Math.round(r.timing.fps)+"    "),e.debugString=i,e.debugTimestamp=n.timing.timestamp),e.debugString){o.font="12px Arial",t.wireframes?o.fillStyle="rgba(255,255,255,0.5)":o.fillStyle="rgba(0,0,0,0.5)";for(var s=e.debugString.split("\n"),a=0;a<s.length;a++)o.fillText(s[a],50,50+18*a)}},h.constraints=function(e,t){for(var o=t,n=0;n<e.length;n++){var i=e[n];if(i.render.visible&&i.pointA&&i.pointB){var r,s=i.bodyA,a=i.bodyB,l=s?A.add(s.position,i.pointA):i.pointA;if("pin"===i.render.type)o.beginPath(),o.arc(l.x,l.y,3,0,2*Math.PI),o.closePath();else{if(r=a?A.add(a.position,i.pointB):i.pointB,o.beginPath(),o.moveTo(l.x,l.y),"spring"===i.render.type)for(var c,d=A.sub(r,l),u=A.perp(A.normalise(d)),p=Math.ceil(f.clamp(i.length/5,12,20)),m=1;m<p;m+=1)o.lineTo(l.x+d.x*(m/p)+u.x*(c=m%2==0?1:-1)*4,l.y+d.y*(m/p)+u.y*c*4);o.lineTo(r.x,r.y)}i.render.lineWidth&&(o.lineWidth=i.render.lineWidth,o.strokeStyle=i.render.strokeStyle,o.stroke()),i.render.anchors&&(o.fillStyle=i.render.strokeStyle,o.beginPath(),o.arc(l.x,l.y,3,0,2*Math.PI),o.arc(r.x,r.y,3,0,2*Math.PI),o.closePath(),o.fill())}}},h.bodyShadows=function(e,t,o){for(var n=o,i=(e.engine,0);i<t.length;i++){var r=t[i];if(r.render.visible){if(r.circleRadius)n.beginPath(),n.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI),n.closePath();else{n.beginPath(),n.moveTo(r.vertices[0].x,r.vertices[0].y);for(var s=1;s<r.vertices.length;s++)n.lineTo(r.vertices[s].x,r.vertices[s].y);n.closePath()}var a=r.position.x-.5*e.options.width,l=r.position.y-.2*e.options.height,c=Math.abs(a)+Math.abs(l);n.shadowColor="rgba(0,0,0,0.15)",n.shadowOffsetX=.05*a,n.shadowOffsetY=.05*l,n.shadowBlur=1+12*Math.min(1,c/1e3),n.fill(),n.shadowColor=null,n.shadowOffsetX=null,n.shadowOffsetY=null,n.shadowBlur=null}}},h.bodies=function(e,t,o){for(var n,i,r,s=o,a=(e.engine,e.options),l=a.showInternalEdges||!a.wireframes,c=0;c<t.length;c++)if((n=t[c]).render.visible)for(r=1<n.parts.length?1:0;r<n.parts.length;r++)if((i=n.parts[r]).render.visible){if(a.showSleeping&&n.isSleeping?s.globalAlpha=.5*i.render.opacity:1!==i.render.opacity&&(s.globalAlpha=i.render.opacity),i.render.sprite&&i.render.sprite.texture&&!a.wireframes){var d=i.render.sprite,u=m(e,d.texture);s.translate(i.position.x,i.position.y),s.rotate(i.angle),s.drawImage(u,u.width*-d.xOffset*d.xScale,u.height*-d.yOffset*d.yScale,u.width*d.xScale,u.height*d.yScale),s.rotate(-i.angle),s.translate(-i.position.x,-i.position.y)}else{if(i.circleRadius)s.beginPath(),s.arc(i.position.x,i.position.y,i.circleRadius,0,2*Math.PI);else{s.beginPath(),s.moveTo(i.vertices[0].x,i.vertices[0].y);for(var p=1;p<i.vertices.length;p++)!i.vertices[p-1].isInternal||l?s.lineTo(i.vertices[p].x,i.vertices[p].y):s.moveTo(i.vertices[p].x,i.vertices[p].y),i.vertices[p].isInternal&&!l&&s.moveTo(i.vertices[(p+1)%i.vertices.length].x,i.vertices[(p+1)%i.vertices.length].y);s.lineTo(i.vertices[0].x,i.vertices[0].y),s.closePath()}a.wireframes?(s.lineWidth=1,s.strokeStyle="#bbb",s.stroke()):(s.fillStyle=i.render.fillStyle,i.render.lineWidth&&(s.lineWidth=i.render.lineWidth,s.strokeStyle=i.render.strokeStyle,s.stroke()),s.fill())}s.globalAlpha=1}},h.bodyWireframes=function(e,t,o){var n,i,r,s,a,l=o,c=e.options.showInternalEdges;for(l.beginPath(),r=0;r<t.length;r++)if((n=t[r]).render.visible)for(a=1<n.parts.length?1:0;a<n.parts.length;a++){for(i=n.parts[a],l.moveTo(i.vertices[0].x,i.vertices[0].y),s=1;s<i.vertices.length;s++)!i.vertices[s-1].isInternal||c?l.lineTo(i.vertices[s].x,i.vertices[s].y):l.moveTo(i.vertices[s].x,i.vertices[s].y),i.vertices[s].isInternal&&!c&&l.moveTo(i.vertices[(s+1)%i.vertices.length].x,i.vertices[(s+1)%i.vertices.length].y);l.lineTo(i.vertices[0].x,i.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()},h.bodyConvexHulls=function(e,t,o){var n,i,r,s=o;for(s.beginPath(),i=0;i<t.length;i++)if((n=t[i]).render.visible&&1!==n.parts.length){for(s.moveTo(n.vertices[0].x,n.vertices[0].y),r=1;r<n.vertices.length;r++)s.lineTo(n.vertices[r].x,n.vertices[r].y);s.lineTo(n.vertices[0].x,n.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},h.vertexNumbers=function(e,t,o){for(var n=o,i=0;i<t.length;i++)for(var r=t[i].parts,s=1<r.length?1:0;s<r.length;s++)for(var a=r[s],l=0;l<a.vertices.length;l++)n.fillStyle="rgba(255,255,255,0.2)",n.fillText(i+"_"+l,a.position.x+.8*(a.vertices[l].x-a.position.x),a.position.y+.8*(a.vertices[l].y-a.position.y))},h.mousePosition=function(e,t,o){o.fillStyle="rgba(255,255,255,0.8)",o.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},h.bodyBounds=function(e,t,o){var n=o,e=(e.engine,e.options);n.beginPath();for(var i=0;i<t.length;i++)if(t[i].render.visible)for(var r=t[i].parts,s=1<r.length?1:0;s<r.length;s++){var a=r[s];n.rect(a.bounds.min.x,a.bounds.min.y,a.bounds.max.x-a.bounds.min.x,a.bounds.max.y-a.bounds.min.y)}e.wireframes?n.strokeStyle="rgba(255,255,255,0.08)":n.strokeStyle="rgba(0,0,0,0.1)",n.lineWidth=1,n.stroke()},h.bodyAxes=function(e,t,o){var n,i,r,s,a=o,l=(e.engine,e.options);for(a.beginPath(),i=0;i<t.length;i++){var c=t[i],d=c.parts;if(c.render.visible)if(l.showAxes)for(r=1<d.length?1:0;r<d.length;r++)for(n=d[r],s=0;s<n.axes.length;s++){var u=n.axes[s];a.moveTo(n.position.x,n.position.y),a.lineTo(n.position.x+20*u.x,n.position.y+20*u.y)}else for(r=1<d.length?1:0;r<d.length;r++)for(n=d[r],s=0;s<n.axes.length;s++)a.moveTo(n.position.x,n.position.y),a.lineTo((n.vertices[0].x+n.vertices[n.vertices.length-1].x)/2,(n.vertices[0].y+n.vertices[n.vertices.length-1].y)/2)}l.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},h.bodyPositions=function(e,t,o){var n,i,r,s,a=o,e=(e.engine,e.options);for(a.beginPath(),r=0;r<t.length;r++)if((n=t[r]).render.visible)for(s=0;s<n.parts.length;s++)i=n.parts[s],a.arc(i.position.x,i.position.y,3,0,2*Math.PI,!1),a.closePath();for(e.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),r=0;r<t.length;r++)(n=t[r]).render.visible&&(a.arc(n.positionPrev.x,n.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},h.bodyVelocity=function(e,t,o){var n=o;n.beginPath();for(var i=0;i<t.length;i++){var r=t[i];r.render.visible&&(n.moveTo(r.position.x,r.position.y),n.lineTo(r.position.x+2*(r.position.x-r.positionPrev.x),r.position.y+2*(r.position.y-r.positionPrev.y)))}n.lineWidth=3,n.strokeStyle="cornflowerblue",n.stroke()},h.bodyIds=function(e,t,o){for(var n=o,i=0;i<t.length;i++)if(t[i].render.visible)for(var r=t[i].parts,s=1<r.length?1:0;s<r.length;s++){var a=r[s];n.font="12px Arial",n.fillStyle="rgba(255,255,255,0.5)",n.fillText(a.id,a.position.x+10,a.position.y-10)}},h.collisions=function(e,t,o){var n,i,r,s,a,l,c=o,e=e.options;for(c.beginPath(),r=0;r<t.length;r++)if((n=t[r]).isActive)for(i=n.collision,s=0;s<n.activeContacts.length;s++){var d=n.activeContacts[s].vertex;c.rect(d.x-1.5,d.y-1.5,3.5,3.5)}for(e.wireframes?c.fillStyle="rgba(255,255,255,0.7)":c.fillStyle="orange",c.fill(),c.beginPath(),r=0;r<t.length;r++)(n=t[r]).isActive&&(i=n.collision,0<n.activeContacts.length)&&(a=n.activeContacts[0].vertex.x,l=n.activeContacts[0].vertex.y,2===n.activeContacts.length&&(a=(n.activeContacts[0].vertex.x+n.activeContacts[1].vertex.x)/2,l=(n.activeContacts[0].vertex.y+n.activeContacts[1].vertex.y)/2),i.bodyB===i.supports[0].body||!0===i.bodyA.isStatic?c.moveTo(a-8*i.normal.x,l-8*i.normal.y):c.moveTo(a+8*i.normal.x,l+8*i.normal.y),c.lineTo(a,l));e.wireframes?c.strokeStyle="rgba(255,165,0,0.7)":c.strokeStyle="orange",c.lineWidth=1,c.stroke()},h.separations=function(e,t,o){var n,i,r,s,a,l=o,e=e.options;for(l.beginPath(),r=0;r<t.length;r++)(i=t[r]).isActive&&(s=(n=i.collision).bodyA,a=1,(i=n.bodyB).isStatic||s.isStatic||(a=.5),i.isStatic&&(a=0),l.moveTo(i.position.x,i.position.y),l.lineTo(i.position.x-n.penetration.x*a,i.position.y-n.penetration.y*a),a=1,i.isStatic||s.isStatic||(a=.5),s.isStatic&&(a=0),l.moveTo(s.position.x,s.position.y),l.lineTo(s.position.x+n.penetration.x*a,s.position.y+n.penetration.y*a));e.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},h.grid=function(e,t,o){var n=o;e.options.wireframes?n.strokeStyle="rgba(255,180,0,0.1)":n.strokeStyle="rgba(255,180,0,0.5)",n.beginPath();for(var i=f.keys(t.buckets),r=0;r<i.length;r++){var s=i[r];t.buckets[s].length<2||(s=s.split(/C|R/),n.rect(.5+parseInt(s[1],10)*t.bucketWidth,.5+parseInt(s[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight))}n.lineWidth=1,n.stroke()},h.inspector=function(e,t){e.engine;var o,n,i,r=e.selected,s=e.render,a=s.options;a.hasBounds&&(n=s.bounds.max.x-s.bounds.min.x,i=s.bounds.max.y-s.bounds.min.y,n=n/s.options.width,i=i/s.options.height,t.scale(1/n,1/i),t.translate(-s.bounds.min.x,-s.bounds.min.y));for(var l=0;l<r.length;l++){var c=r[l].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),c.type){case"body":o=c.bounds,t.beginPath(),t.rect(Math.floor(o.min.x-3),Math.floor(o.min.y-3),Math.floor(o.max.x-o.min.x+6),Math.floor(o.max.y-o.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var d=c.pointA;c.bodyA&&(d=c.pointB),t.beginPath(),t.arc(d.x,d.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",o=e.selectBounds,t.beginPath(),t.rect(Math.floor(o.min.x),Math.floor(o.min.y),Math.floor(o.max.x-o.min.x),Math.floor(o.max.y-o.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),a.hasBounds&&t.setTransform(1,0,0,1,0,0)};var o=function(e,t){var o=document.createElement("canvas");return o.width=e,o.height=t,o.oncontextmenu=function(){return!1},o.onselectstart=function(){return!1},o},i=function(e){e=e.getContext("2d");return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},m=function(e,t){var o=e.textures[t];return o||((o=e.textures[t]=new Image).src=t,o)},x=function(e,t){var o=t;/(jpg|gif|png)$/.test(t)&&(o="url("+t+")"),e.canvas.style.background=o,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(e,t,o){var v={};t.exports=v;var g=e("../geometry/Bounds"),x=e("../body/Composite"),m=e("../core/Common"),i=e("../core/Events"),h=e("../geometry/Vector");!function(){var n,t;"undefined"!=typeof window&&(n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(m.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),v.create=function(e){m.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var t=m.extend({controller:v,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},e),o=!t.options.wireframes&&"transparent"===t.options.background;return t.pixiOptions=t.pixiOptions||{view:t.canvas,transparent:o,antialias:!0,backgroundColor:e.background},t.mouse=e.mouse,t.engine=e.engine,t.renderer=t.renderer||new PIXI.WebGLRenderer(t.options.width,t.options.height,t.pixiOptions),t.container=t.container||new PIXI.Container,t.spriteContainer=t.spriteContainer||new PIXI.Container,t.canvas=t.canvas||t.renderer.view,t.bounds=t.bounds||{min:{x:0,y:0},max:{x:t.options.width,y:t.options.height}},i.on(t.engine,"beforeUpdate",function(){v.clear(t)}),t.textures={},t.sprites={},t.primitives={},t.container.addChild(t.spriteContainer),m.isElement(t.element)?t.element.appendChild(t.canvas):m.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),t.canvas.oncontextmenu=function(){return!1},t.canvas.onselectstart=function(){return!1},t},v.run=function(o){!function e(t){o.frameRequestId=n(e),v.world(o)}()},v.stop=function(e){t(e.frameRequestId)},v.clear=function(e){for(var t=e.container,o=e.spriteContainer;t.children[0];)t.removeChild(t.children[0]);for(;o.children[0];)o.removeChild(o.children[0]);var n=e.sprites["bg-0"];e.textures={},e.sprites={},e.primitives={},(e.sprites["bg-0"]=n)&&t.addChildAt(n,0),e.container.addChild(e.spriteContainer),e.currentBackground=null,t.scale.set(1,1),t.position.set(0,0)},v.setBackground=function(e,t){var o,n,i;e.currentBackground!==t&&(o=t.indexOf&&-1!==t.indexOf("#"),n=e.sprites["bg-0"],o?(i=m.colorToNumber(t),e.renderer.backgroundColor=i,n&&e.container.removeChild(n)):n||(i=r(e,t),(n=e.sprites["bg-0"]=new PIXI.Sprite(i)).position.x=0,n.position.y=0,e.container.addChildAt(n,0)),e.currentBackground=t)},v.world=function(e){var t,o=e.engine.world,n=e.renderer,i=e.container,r=e.options,s=x.allBodies(o),a=x.allConstraints(o),l=[];r.wireframes?v.setBackground(e,r.wireframeBackground):v.setBackground(e,r.background);var c=e.bounds.max.x-e.bounds.min.x,o=e.bounds.max.y-e.bounds.min.y,c=c/e.options.width,o=o/e.options.height;if(r.hasBounds){for(t=0;t<s.length;t++){var d=s[t];d.render.sprite.visible=g.overlaps(d.bounds,e.bounds)}for(t=0;t<a.length;t++){var u=a[t],p=u.bodyA,m=u.bodyB,f=u.pointA,y=u.pointB;p&&(f=h.add(p.position,u.pointA)),m&&(y=h.add(m.position,u.pointB)),f&&y&&(g.contains(e.bounds,f)||g.contains(e.bounds,y))&&l.push(u)}i.scale.set(1/c,1/o),i.position.set(-e.bounds.min.x*(1/c),-e.bounds.min.y*(1/o))}else l=a;for(t=0;t<s.length;t++)v.body(e,s[t]);for(t=0;t<l.length;t++)v.constraint(e,l[t]);n.render(i)},v.constraint=function(e,t){e.engine;var o=t.bodyA,n=t.bodyB,i=t.pointA,r=t.pointB,s=e.container,a=t.render,l="c-"+t.id,c=(c=e.primitives[l])||(e.primitives[l]=new PIXI.Graphics);a.visible&&t.pointA&&t.pointB?(-1===m.indexOf(s.children,c)&&s.addChild(c),c.clear(),c.beginFill(0,0),c.lineStyle(a.lineWidth,m.colorToNumber(a.strokeStyle),1),o?c.moveTo(o.position.x+i.x,o.position.y+i.y):c.moveTo(i.x,i.y),n?c.lineTo(n.position.x+r.x,n.position.y+r.y):c.lineTo(r.x,r.y),c.endFill()):c.clear()},v.body=function(e,t){e.engine;var o,n,i,r=t.render;r.visible&&(r.sprite&&r.sprite.texture?(o="b-"+t.id,i=e.sprites[o],n=e.spriteContainer,i=i||(e.sprites[o]=s(e,t)),-1===m.indexOf(n.children,i)&&n.addChild(i),i.position.x=t.position.x,i.position.y=t.position.y,i.rotation=t.angle,i.scale.x=r.sprite.xScale||1,i.scale.y=r.sprite.yScale||1):(n="b-"+t.id,i=e.primitives[n],r=e.container,i||((i=e.primitives[n]=a(e,t)).initialAngle=t.angle),-1===m.indexOf(r.children,i)&&r.addChild(i),i.position.x=t.position.x,i.position.y=t.position.y,i.rotation=t.angle-i.initialAngle))};var s=function(e,t){var o=t.render.sprite.texture,o=r(e,o),o=new PIXI.Sprite(o);return o.anchor.x=t.render.sprite.xOffset,o.anchor.y=t.render.sprite.yOffset,o},a=function(e,t){var o,n=t.render,i=e.options,r=new PIXI.Graphics,s=m.colorToNumber(n.fillStyle),a=m.colorToNumber(n.strokeStyle),l=m.colorToNumber(n.strokeStyle),c=m.colorToNumber("#bbb"),d=m.colorToNumber("#CD5C5C");r.clear();for(var u=1<t.parts.length?1:0;u<t.parts.length;u++){o=t.parts[u],i.wireframes?(r.beginFill(0,0),r.lineStyle(1,c,1)):(r.beginFill(s,1),r.lineStyle(n.lineWidth,a,1)),r.moveTo(o.vertices[0].x-t.position.x,o.vertices[0].y-t.position.y);for(var p=1;p<o.vertices.length;p++)r.lineTo(o.vertices[p].x-t.position.x,o.vertices[p].y-t.position.y);r.lineTo(o.vertices[0].x-t.position.x,o.vertices[0].y-t.position.y),r.endFill(),(i.showAngleIndicator||i.showAxes)&&(r.beginFill(0,0),i.wireframes?r.lineStyle(1,d,1):r.lineStyle(1,l),r.moveTo(o.position.x-t.position.x,o.position.y-t.position.y),r.lineTo((o.vertices[0].x+o.vertices[o.vertices.length-1].x)/2-t.position.x,(o.vertices[0].y+o.vertices[o.vertices.length-1].y)/2-t.position.y),r.endFill())}return r},r=function(e,t){return e.textures[t]||(e.textures[t]=PIXI.Texture.fromImage(t))}}()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)});